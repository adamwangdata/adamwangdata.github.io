
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Farmer’s Fridge Yelp Reviews Analysis &#8212; Portfolio</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/math-aw.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Time Series Forecasting" href="forecast.html" />
    <link rel="prev" title="Predicting Churn with Amazon SageMaker" href="../deploy/churn.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Portfolio</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../preface.html">
                    Preface
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Deploying Models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../deploy/churn.html">
   Predicting Churn with Amazon SageMaker
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistics and Machine Learning
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Farmer’s Fridge Yelp Reviews Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="forecast.html">
   Time Series Forecasting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reconstruct.html">
   Time Series Reconstruction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="resources.html">
   More Examples and Learning Resources
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../python/euler.html">
   Project Euler
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/stat-ml/ff_yelp.py"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.py</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-source">
   Data Source
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-cleaning-and-exploration">
   Data Cleaning and Exploration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analysis">
   Exploratory Data Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ratings-over-time">
     Ratings Over Time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-items-are-popular">
     What Items are Popular?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-phrases-are-common">
     What Phrases are Common?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#future-work">
   Future Work
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Farmer’s Fridge Yelp Reviews Analysis</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-source">
   Data Source
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-cleaning-and-exploration">
   Data Cleaning and Exploration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analysis">
   Exploratory Data Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ratings-over-time">
     Ratings Over Time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-items-are-popular">
     What Items are Popular?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-phrases-are-common">
     What Phrases are Common?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#future-work">
   Future Work
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="farmer-s-fridge-yelp-reviews-analysis">
<span id="yelp"></span><h1>Farmer’s Fridge Yelp Reviews Analysis<a class="headerlink" href="#farmer-s-fridge-yelp-reviews-analysis" title="Permalink to this headline">#</a></h1>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>Using data from 173 Yelp reviews for three major fridge locations, I examined trends like average ratings over time, item popularity, and common phrases mentioned in reviews.
The results show that, pre-pandemic:</p>
<ol class="simple">
<li><p>The airport location had more and, on average, better ratings while it was active</p></li>
<li><p>Salad popularity decreased over time while bowl and sandwich popularities increased, but salads are still by far the most popular type of item</p></li>
</ol>
<p>Common positive phrases include “healthy”, “good”, and “fresh”, while analysis of negative reviews suggests price and portion sizes factored into their low ratings.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can run and modify the code on this page Jupyter Notebook style, but without leaving the page!
Hover over the <span class="fa fa-rocket"></span> launch button at the top of the page, then click the <span class="guilabel">Live Code</span> button.
Once you see “Launching from mybinder.org: ready”, you can run code cells.
Refresh the page to revert to the original view.</p>
</div>
</section>
<section id="data-source">
<h2>Data Source<a class="headerlink" href="#data-source" title="Permalink to this headline">#</a></h2>
<p>I scraped Yelp reviews using the Selenium package on 6/20/2021.
Data include rating (1 out of 5 stars), the main text of the review, and metadata like the the number of Yelp reviews a user has given or the number of people who found a review useful.
Each review constitutes a row in the <code class="docutils literal notranslate"><span class="pre">yelp.csv</span></code> file, with each piece of data (rating, text, etc.) as a separate column.</p>
<p>I scraped three different Chicago fridges.
I found the locations by manually navigating Yelp’s website and searching for “farmer’s fridge” in Chicago and selecting fridges with &gt; 10 reviews.
The three fridges have <a class="reference external" href="https://www.yelp.com/biz/farmers-fridge-chicago-13">93 reviews</a>, <a class="reference external" href="https://www.yelp.com/biz/farmers-fridge-chicago-14">23 reviews</a>, and <a class="reference external" href="https://www.yelp.com/biz/farmers-fridge-chicago-87">57 reviews</a> for a total of 173 reviews.
Two fridges are located in The Loop, while the third location with 57 reviews is located in O’Hare International Airport.</p>
<p>My complete code to scrape the reviews can be toggled below, but is not the main focus of this writeup.</p>
<div class="toggle docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">NoSuchElementException</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">csv</span>

<span class="k">def</span> <span class="nf">scrape_reviews</span><span class="p">(</span><span class="n">yelp_url</span><span class="p">,</span> <span class="n">sleep_time</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Retrieve all text data from reviews, including star rating.</span>
<span class="sd">    Sleep between pages of reviews so the html loads before accessing data.&quot;&quot;&quot;</span>
    <span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">()</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">yelp_url</span><span class="p">)</span>

    <span class="n">all_reviews</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">more_pages_exist</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">more_pages_exist</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>  <span class="c1"># Wait for page to load</span>
        <span class="n">reviews</span> <span class="o">=</span> <span class="n">get_reviews_on_page</span><span class="p">(</span><span class="n">browser</span><span class="p">)</span>
        <span class="n">all_reviews</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">reviews</span><span class="p">)</span>
        <span class="n">click_succeeded</span> <span class="o">=</span> <span class="n">click_on_next_page</span><span class="p">(</span><span class="n">browser</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">click_succeeded</span><span class="p">:</span>
            <span class="n">more_pages_exist</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">all_reviews</span>

<span class="k">def</span> <span class="nf">get_reviews_on_page</span><span class="p">(</span><span class="n">browser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract reviews on a Yelp page.&quot;&quot;&quot;</span>
    <span class="n">reviews</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">review_num</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">more_reviews_exist</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">more_reviews_exist</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">review</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                <span class="s2">&quot;/html/body/div[2]/div[2]/yelp-react-root/div/div[3]/div/div&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;/div[2]/div/div[1]/div[2]/section[2]/div[2]/div/ul&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;/li[&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">review_num</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;/div&quot;</span>
            <span class="p">)</span>
            <span class="n">rating</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                <span class="s2">&quot;/html/body/div[2]/div[2]/yelp-react-root/div/div[3]/div/div/&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;div[2]/div/div[1]/div[2]/section[2]/div[2]/div/ul&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;/li[&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">review_num</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;/div/div[2]/div/div[1]/span/div&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;aria-label&#39;</span><span class="p">)</span>

            <span class="n">reviews</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rating</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">review</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">review_num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">NoSuchElementException</span><span class="p">:</span>  <span class="c1"># No more reviews on page</span>
            <span class="n">more_reviews_exist</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">reviews</span>

<span class="k">def</span> <span class="nf">click_on_next_page</span><span class="p">(</span><span class="n">browser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Click on the next page of Yelp reviews, if it exists. Returns</span>
<span class="sd">    whether the next page exists.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">next_page_button</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span>
            <span class="s1">&#39;.next-link&#39;</span>
        <span class="p">)</span>
        <span class="n">next_page_button</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="n">NoSuchElementException</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">write_to_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">reviews</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write the following data as columns in a csv file:</span>
<span class="sd">        - rating (1 to 5 scale)</span>
<span class="sd">        - reviewer data: name, location, number of friends, number of</span>
<span class="sd">            reviews, and number of photos</span>
<span class="sd">        - review data: date of review, updated or not, review text,</span>
<span class="sd">            number of people who found the review useful, funny, and cool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">append</span> <span class="k">else</span> <span class="s1">&#39;w&#39;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">append</span><span class="p">:</span>
            <span class="n">header</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;rating&#39;</span><span class="p">,</span>
                <span class="s1">&#39;name&#39;</span><span class="p">,</span>
                <span class="s1">&#39;elite&#39;</span><span class="p">,</span>
                <span class="s1">&#39;reviewer_location&#39;</span><span class="p">,</span>
                <span class="s1">&#39;n_friends&#39;</span><span class="p">,</span>
                <span class="s1">&#39;n_reviews&#39;</span><span class="p">,</span>
                <span class="s1">&#39;n_photos&#39;</span><span class="p">,</span>
                <span class="s1">&#39;review_photos&#39;</span><span class="p">,</span>
                <span class="s1">&#39;date&#39;</span><span class="p">,</span>
                <span class="s1">&#39;updated&#39;</span><span class="p">,</span>
                <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                <span class="s1">&#39;n_useful&#39;</span><span class="p">,</span>
                <span class="s1">&#39;n_funny&#39;</span><span class="p">,</span>
                <span class="s1">&#39;n_cool&#39;</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">location</span><span class="p">:</span>
                <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;restaurant_location&#39;</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">review</span> <span class="ow">in</span> <span class="n">reviews</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">process_review</span><span class="p">(</span><span class="n">review</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">location</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">process_review</span><span class="p">(</span><span class="n">review</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Process the structure of a Yelp review line by line into a row</span>
<span class="sd">    to be appended by the `write_to_csv()` function.&quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">review</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">rating</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Reviewer data</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_elite</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">elite</span> <span class="o">=</span> <span class="s1">&#39;True&#39;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">elite</span> <span class="o">=</span> <span class="s1">&#39;False&#39;</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">n_friends</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">n_reviews</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">n_photos</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_photos</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Review data</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_updated_review</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">updated</span> <span class="o">=</span> <span class="s1">&#39;True&#39;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">updated</span> <span class="o">=</span> <span class="s1">&#39;False&#39;</span>
    <span class="k">if</span> <span class="n">has_photos</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">review_photos</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">has_photos</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">single</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">review_photos</span> <span class="o">=</span> <span class="n">strip_nonint</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;photos&#39;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">review_photos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">end_of_review_text</span> <span class="o">=</span> <span class="n">find_end_of_review_text</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">[:</span><span class="n">end_of_review_text</span><span class="p">])</span>
    <span class="n">n_useful</span> <span class="o">=</span> <span class="n">strip_nonint</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">end_of_review_text</span><span class="p">],</span> <span class="s1">&#39;Useful&#39;</span><span class="p">)</span>
    <span class="n">n_funny</span> <span class="o">=</span> <span class="n">strip_nonint</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">end_of_review_text</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Funny&#39;</span><span class="p">)</span>
    <span class="n">n_cool</span> <span class="o">=</span> <span class="n">strip_nonint</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">end_of_review_text</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;Cool&#39;</span><span class="p">)</span>

    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">rating</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">elite</span><span class="p">,</span>
        <span class="n">location</span><span class="p">,</span>
        <span class="n">n_friends</span><span class="p">,</span>
        <span class="n">n_reviews</span><span class="p">,</span>
        <span class="n">n_photos</span><span class="p">,</span>
        <span class="n">review_photos</span><span class="p">,</span>
        <span class="n">date</span><span class="p">,</span>
        <span class="n">updated</span><span class="p">,</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">n_useful</span><span class="p">,</span>
        <span class="n">n_funny</span><span class="p">,</span>
        <span class="n">n_cool</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">row</span>

<span class="k">def</span> <span class="nf">find_end_of_review_text</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find which line the main text of a review ends.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">line1</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">line2</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">line3</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Useful&#39;</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">line2</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Funny&#39;</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">line3</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Cool&#39;</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">i</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: no expected end of text found.&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">is_elite</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determine if given string is an elite Yelp user.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Elite&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">is_int</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determine if given string is an integer.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">has_photos</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determine if given string ends in &#39;photo&#39; or &#39;photos&#39;.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">single</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;photo&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;photos&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">is_updated_review</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determine if given string indicates an updated Yelp review.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">string</span> <span class="o">==</span> <span class="s2">&quot;Updated review&quot;</span>

<span class="k">def</span> <span class="nf">strip_nonint</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">word_to_strip</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Strip words and spaces from a string, keeping non-integer parts</span>
<span class="sd">    after stripping. If the remaining piece is not an integer, return &#39;0&#39;.</span>
<span class="sd">    So, &#39;Useful 12&#39; becomes &#39;12&#39; while &#39;Useful&#39; becomes &#39;0&#39;.&quot;&quot;&quot;</span>
    <span class="n">stripped</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">word_to_strip</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_int</span><span class="p">(</span><span class="n">stripped</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">stripped</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;0&#39;</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">url_location_pairs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;https://www.yelp.com/biz/farmers-fridge-chicago-13&#39;</span><span class="p">,</span> <span class="s1">&#39;The Loop 1&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;https://www.yelp.com/biz/farmers-fridge-chicago-14&#39;</span><span class="p">,</span> <span class="s1">&#39;The Loop 2&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;https://www.yelp.com/biz/farmers-fridge-chicago-87&#39;</span><span class="p">,</span> <span class="s2">&quot;O&#39;Hare Airport&quot;</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;yelp.csv&#39;</span>

    <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Determine when to write to a new file or append to existing one</span>
    <span class="k">for</span> <span class="n">url</span><span class="p">,</span> <span class="n">location</span> <span class="ow">in</span> <span class="n">url_location_pairs</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scraping url number </span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">reviews</span> <span class="o">=</span> <span class="n">scrape_reviews</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">write_to_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">reviews</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">write_to_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">reviews</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</section>
<section id="data-cleaning-and-exploration">
<h2>Data Cleaning and Exploration<a class="headerlink" href="#data-cleaning-and-exploration" title="Permalink to this headline">#</a></h2>
<p>Let’s load in the data and examine it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;yelp.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating</th>
      <th>name</th>
      <th>elite</th>
      <th>reviewer_location</th>
      <th>n_friends</th>
      <th>n_reviews</th>
      <th>n_photos</th>
      <th>review_photos</th>
      <th>date</th>
      <th>updated</th>
      <th>text</th>
      <th>n_useful</th>
      <th>n_funny</th>
      <th>n_cool</th>
      <th>business_location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>Josh C.</td>
      <td>True</td>
      <td>Chicago, IL</td>
      <td>215</td>
      <td>22</td>
      <td>129</td>
      <td>9</td>
      <td>1/9/2021</td>
      <td>False</td>
      <td>We received a Farmer's Fridge delivery straigh...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>The Loop 1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>Jim Z.</td>
      <td>False</td>
      <td>Napa, CA</td>
      <td>0</td>
      <td>25</td>
      <td>8</td>
      <td>0</td>
      <td>5/19/2021</td>
      <td>False</td>
      <td>Repeat buyer... awesome food, great service......</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>The Loop 1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>Kathy L.</td>
      <td>False</td>
      <td>New Berlin, WI</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>4/2/2021</td>
      <td>False</td>
      <td>So happy I found Farmers Fridge in MKE airport...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>The Loop 1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>Regina X.</td>
      <td>True</td>
      <td>Seattle, WA</td>
      <td>521</td>
      <td>220</td>
      <td>432</td>
      <td>0</td>
      <td>9/1/2019</td>
      <td>False</td>
      <td>The business stock photos did not prepare me f...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>The Loop 1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Alice J.</td>
      <td>False</td>
      <td>Oak Park, IL</td>
      <td>0</td>
      <td>23</td>
      <td>1</td>
      <td>0</td>
      <td>8/14/2020</td>
      <td>False</td>
      <td>$8 for a salad in a jar.\n$8.\nThis is ridicul...</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>The Loop 1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The important variables that will be used for this analysis are:</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rating</span></code>: an integer rating between 1 (worst) and 5 (best)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">date</span></code>: the date the review was posted on Yelp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">text</span></code>: the main contents of the review</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">business_location</span></code>: the location of the fridge</p></li>
</ol>
<p>The others are not used, but some ideas how of how to use them are sketched in § <a class="reference internal" href="#yelp-future"><span class="std std-ref">Future Work</span></a>.</p>
<p>It’s much more convenient to work with datetime objects, so let’s convert them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can easily group reviews by year.
Also grouping by fridge (i.e. business) location, we can count the number of reviews posted at each location in a given year:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_by_year_and_loc</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">business_location</span><span class="p">])</span>
<span class="n">annual_counts</span> <span class="o">=</span> <span class="n">grouped_by_year_and_loc</span><span class="o">.</span><span class="n">rating</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">annual_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>business_location</th>
      <th>O'Hare Airport</th>
      <th>The Loop 1</th>
      <th>The Loop 2</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013</th>
      <td>NaN</td>
      <td>13.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>NaN</td>
      <td>21.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>NaN</td>
      <td>22.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>NaN</td>
      <td>19.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>10.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>24.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2019</th>
      <td>19.0</td>
      <td>3.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>4.0</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">annual_counts</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Number of Annual Reviews&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(0.5, 0, &#39;Year&#39;), Text(0, 0.5, &#39;Number of Annual Reviews&#39;)]
</pre></div>
</div>
<img alt="../_images/ff_yelp_10_1.png" src="../_images/ff_yelp_10_1.png" />
</div>
</div>
<p>The first Loop location seems to have been one of the first fridges, with reviews available in the same year the company was founded.
The number of reviews per year begins to decline around 2016, coinciding with the opening up of the second Loop location.
In 2017, a fridge location in O’Hare international airport opened up and became relatively popular.
In 2020, when the effects of the COVID-19 pandemic drastically altered lives of Chicago residents, the number of reviews also drastically declined, continuing into 2021.</p>
<p>If we’re interested in annual trends over time, it may helpful to combine the two Loop locations to avoid aggregates from only 5 or fewer reviews:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">def</span> <span class="nf">combine_loop_locations</span><span class="p">(</span><span class="n">locations</span><span class="p">):</span>
    <span class="n">combined_locations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">locations</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">loc</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;The Loop&quot;</span><span class="p">):</span>
            <span class="n">combined_locations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;The Loop&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">combined_locations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">combined_locations</span>


<span class="n">df</span><span class="p">[</span><span class="s2">&quot;combined_location&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">combine_loop_locations</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">business_location</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">combined_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&quot;O&#39;Hare Airport&quot;, &#39;The Loop&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="exploratory-data-analysis">
<h2>Exploratory Data Analysis<a class="headerlink" href="#exploratory-data-analysis" title="Permalink to this headline">#</a></h2>
<p>This section examines a few specific questions, focusing on graphical presentation and inuition rather than formal statistical tests.
These analyses can help inform what avenues Farmer’s Fridge could look into in the future and serve as a foundation for more detailed analyses later.</p>
<section id="ratings-over-time">
<h3>Ratings Over Time<a class="headerlink" href="#ratings-over-time" title="Permalink to this headline">#</a></h3>
<p>A plot of annual ratings over time, grouped by location, can be constructed by grouping by the relevant variables and invoking the <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> method.
In addition, I’ll overlay points with sizes proportional to the number of reviews.
This allows us to quickly weight large points more than small points.
This is important especially for 2020 and 2021 when there is very little data;
for example, the 5/5 rating data for the Loop locations in 2021 is only based on 3 reviews.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">grouped_by_year_and_loc</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">combined_location</span><span class="p">])</span>
<span class="n">annual_ratings</span> <span class="o">=</span> <span class="n">grouped_by_year_and_loc</span><span class="o">.</span><span class="n">rating</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">annual_counts</span> <span class="o">=</span> <span class="n">grouped_by_year_and_loc</span><span class="o">.</span><span class="n">rating</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">annual_ratings</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Average Annual Rating (1 to 5)&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">loc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">annual_ratings</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">point_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span> <span class="o">*</span> <span class="n">count</span> <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">annual_counts</span><span class="p">[</span><span class="n">loc</span><span class="p">]]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">annual_ratings</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">annual_ratings</span><span class="p">[</span><span class="n">loc</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">point_sizes</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ff_yelp_14_0.png" src="../_images/ff_yelp_14_0.png" />
</div>
</div>
<p>There appears to have been a steady decline in rating throughout 2016.
In 2017, the Loop location’s rating fell substantially but the introduction of the O’Hare location was a success.
The Loop location rebounded somewhat and the O’Hare location continued to see success, until the pandemic hit, drastically lowering the number of ratings available in 2020 and 2021.</p>
</section>
<section id="what-items-are-popular">
<h3>What Items are Popular?<a class="headerlink" href="#what-items-are-popular" title="Permalink to this headline">#</a></h3>
<p>A simple analysis assumes a correlation between the number of mentions of an item and its popularity.
I’ve grouped the items like Farmer’s Fridge’s <a class="reference external" href="https://www.farmersfridge.com/menu">website menu</a>, as well as words that are likely to belong in that grouping. Terms synonymous with salad, for example, are</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">salads</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Smoked Cheddar Cobb Salad&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Buffalo Chicken Ranch Salad&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Elote Salad&quot;</span><span class="p">,</span>
    <span class="s2">&quot;North Napa Salad&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Grilled Chicken Caesar Salad&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Southwest Salad with Chipotle Chicken&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Green Goddess Salad&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Greek Salad&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Salad&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The other groupings are defind as follows:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bowls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Apple Cinnamon Oats&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Falafel Bowl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Pesto Pasta Bowl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Thai Noodle Bowl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Burrito Bowl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Red Chile Braised Pork Bowl by Rick Bayless&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Pineapple Coconut Chia Pudding&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Berries &amp; Granola Greek Yogurt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Almond Butter Oats Bowl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Chickpea Tikka Masala&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Chicken Tikka Masala&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Grilled Chicken &amp; Veggie Bowl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Truffle Couscous with Chicken&quot;</span> <span class="s2">&quot;Bowl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;oats&quot;</span><span class="p">,</span>
    <span class="s2">&quot;yogurt&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">sandwiches</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Italian Turkey Wrap&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Turkey, Apple &amp; White Cheddar Wrap&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sandwich&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Wrap&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">snacks</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;White Cheddar Cheese&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Cookie Dough Bites&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Dark Chocolate Trail Mix&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Chips &amp; Guac&quot;</span><span class="p">,</span>
    <span class="s2">&quot;snack&quot;</span><span class="p">,</span>
    <span class="s2">&quot;trail&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dough&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">proteins</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Falafel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Grilled Chicken&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">drinks</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;La Colombe Vanilla Draft Latte&quot;</span><span class="p">,</span>
    <span class="s2">&quot;La Colombe Triple Draft Latte&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Brew Dr. Kombucha Love&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Spindrift Raspberry Lime&quot;</span><span class="p">,</span>
    <span class="s2">&quot;drink&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>With the item groups defined, let’s count unique mentions of each group:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">count_item_mentions</span><span class="p">(</span><span class="n">reviews</span><span class="p">,</span> <span class="n">item_group</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute percentage of times an item in `item_group` is mentioned</span>
<span class="sd">    in a review.&quot;&quot;&quot;</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">reviews</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">item_group</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">reviews</span><span class="p">)</span>


<span class="n">item_mention_counts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;salads&quot;</span><span class="p">:</span> <span class="n">count_item_mentions</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">salads</span><span class="p">),</span>
    <span class="s2">&quot;bowls&quot;</span><span class="p">:</span> <span class="n">count_item_mentions</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">bowls</span><span class="p">),</span>
    <span class="s2">&quot;sandwiches&quot;</span><span class="p">:</span> <span class="n">count_item_mentions</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">sandwiches</span><span class="p">),</span>
    <span class="s2">&quot;snacks&quot;</span><span class="p">:</span> <span class="n">count_item_mentions</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">snacks</span><span class="p">),</span>
    <span class="s2">&quot;proteins&quot;</span><span class="p">:</span> <span class="n">count_item_mentions</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">proteins</span><span class="p">),</span>
    <span class="s2">&quot;drinks&quot;</span><span class="p">:</span> <span class="n">count_item_mentions</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">drinks</span><span class="p">),</span>
<span class="p">}</span>
<span class="n">item_mention_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;salads&#39;: 0.7052023121387283,
 &#39;bowls&#39;: 0.10404624277456648,
 &#39;sandwiches&#39;: 0.07514450867052024,
 &#39;snacks&#39;: 0.10982658959537572,
 &#39;proteins&#39;: 0.023121387283236993,
 &#39;drinks&#39;: 0.005780346820809248}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">item_mention_counts</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">list</span><span class="p">(</span><span class="n">item_mention_counts</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Fraction of times mentioned in a review&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(0.5, 0, &#39;Fraction of times mentioned in a review&#39;)]
</pre></div>
</div>
<img alt="../_images/ff_yelp_21_1.png" src="../_images/ff_yelp_21_1.png" />
</div>
</div>
<p>Salads are the overwhelming favorite.
Have these trends changed over time?
Below is the annual share for each item type, i.e. the fraction of times an item was mentioned in a review for a given year.
Weighting by total number of reviews that year is again used.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">annual_item_share_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">item_group</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">annual_share</span> <span class="o">=</span> <span class="n">grouped_by_year_and_loc</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="n">count_item_mentions</span><span class="p">,</span> <span class="n">item_group</span><span class="o">=</span><span class="n">item_group</span>
    <span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
    <span class="n">annual_share</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Annual share&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">loc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">annual_counts</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
        <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">point_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span> <span class="o">*</span> <span class="n">count</span> <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">annual_counts</span><span class="p">[</span><span class="n">loc</span><span class="p">]]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">annual_share</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">annual_share</span><span class="p">[</span><span class="n">loc</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">point_sizes</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">9.6</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">annual_item_share_plot</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">salads</span><span class="p">,</span> <span class="s2">&quot;Salad Popularity&quot;</span><span class="p">)</span>
<span class="n">annual_item_share_plot</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">bowls</span><span class="p">,</span> <span class="s2">&quot;Bowl Popularity&quot;</span><span class="p">)</span>
<span class="n">annual_item_share_plot</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sandwiches</span><span class="p">,</span> <span class="s2">&quot;Sandwich Popularity&quot;</span><span class="p">)</span>
<span class="n">annual_item_share_plot</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">snacks</span><span class="p">,</span> <span class="s2">&quot;Snack Popularity&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ff_yelp_23_0.png" src="../_images/ff_yelp_23_0.png" />
</div>
</div>
<p>Salad popularity has been decreasing, but still has the largest share.
Bowl popularity seems to have the opposite trend, though still have a smaller share.
Sandwiches seem popular at airports, with a sudden drop in 2020 (perhaps due to the pandemic, as sandwiches are not usually eaten with utensils?)
Finally, snacks were initially popular (perhaps because of vending machine familiarity?) but have somewhat declined, except for 2021 where there are only 3 data points.</p>
</section>
<section id="what-phrases-are-common">
<h3>What Phrases are Common?<a class="headerlink" href="#what-phrases-are-common" title="Permalink to this headline">#</a></h3>
<p>We can answer this question with more sophisticated language processing.
Using NLTK, the Natural Language Toolkit, we can parse out individual words in a string of unstructured text, or more generally ngrams that contain n words strung together.
Before any of that, let’s define a function that combines all the reviews in the <code class="docutils literal notranslate"><span class="pre">df.text</span></code> column of a dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">combine_review_text</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">review_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
        <span class="n">review_text</span> <span class="o">+=</span> <span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">3</span>
    <span class="k">return</span> <span class="n">review_text</span>


<span class="n">text</span> <span class="o">=</span> <span class="n">combine_review_text</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">[:</span><span class="mi">1200</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>We received a Farmer&#39;s Fridge delivery straight to our doors! We got a text when the driver was close and when the delivery was made. It was so easy and super convenient.

Their menu includes everything from salads to breakfast items to dinner plates and snacks. We received a variety and not only was it delicious, it was healthy and filling! Salads are typically not our first choice, but we were so impressed with how much flavor was packed into each one and am already craving them again!

We have tried other meal delivery services but were impressed with Farmer&#39;s Fridge the most. The convenience of the order, the ease of preparing the meal, and the overall quality and healthy options puts them above the competition. We can&#39;t wait to try more of their menu! Already eyeing the Buffalo Mac &amp; Cheese and the Enchilada Roja plates......
See all photos from Josh C. for Farmer&#39;s Fridge


Repeat buyer... awesome food, great service... highly recommend!!! AAAA ++++
The salads are fresh and very tasty


So happy I found Farmers Fridge in MKE airport!!!! As a flight attendant it was wonderful finding their  &quot;fridge&quot; full of many, many fresh, nutritional and delicious food items!!  I couldn&#39;t d
</pre></div>
</div>
</div>
</div>
<p>Next, let’s import <code class="docutils literal notranslate"><span class="pre">nltk</span></code> and get a list of words.
Technically in language processing terms, we are extracting <em>tokens</em>, since objects like punctuation are retained.
It’s also useful to drop the most common words like “to”, “then”, and “the” using <code class="docutils literal notranslate"><span class="pre">nltk</span></code>’s library of English stop words and convert everything to lowercase for simplicity (must download stopwords and punk):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nltk</span>

<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;stopwords&quot;</span><span class="p">)</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;punkt&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>

<span class="n">stop_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s2">&quot;english&quot;</span><span class="p">))</span>
<span class="n">words</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">filtered_lowercase_words</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop_words</span><span class="p">:</span>
        <span class="n">filtered_lowercase_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<span class="n">filtered_lowercase_words</span><span class="p">[:</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nltk_data] Downloading package stopwords to
[nltk_data]     /home/adam/projects/website/env/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package punkt to
[nltk_data]     /home/adam/projects/website/env/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;received&#39;,
 &#39;farmer&#39;,
 &quot;&#39;s&quot;,
 &#39;fridge&#39;,
 &#39;delivery&#39;,
 &#39;straight&#39;,
 &#39;doors&#39;,
 &#39;!&#39;,
 &#39;got&#39;,
 &#39;text&#39;,
 &#39;driver&#39;,
 &#39;close&#39;]
</pre></div>
</div>
</div>
</div>
<p>The result is terse, but the meaning of sentences are maintained.</p>
<p>Now we’re ready to count the most common words and display them.
I’ll define functions for general ngrams for later use.
So even though it is overkill to use a “onegram” for just a list of words we already have, I will for generalizibility.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nltk.util</span> <span class="kn">import</span> <span class="n">ngrams</span>


<span class="k">def</span> <span class="nf">count_ngrams</span><span class="p">(</span><span class="n">ngrams</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a dictionary of ngram, count pairs.&quot;&quot;&quot;</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="nb">tuple</span> <span class="ow">in</span> <span class="n">ngrams</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">tuple</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">:</span>
            <span class="n">counts</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">counts</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">counts</span>


<span class="k">def</span> <span class="nf">sort_dict_by_vals</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="n">sorted_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])}</span>
    <span class="k">return</span> <span class="n">sorted_dict</span>


<span class="k">def</span> <span class="nf">print_top_vals</span><span class="p">(</span><span class="n">ngram_counts</span><span class="p">,</span> <span class="n">min_count</span><span class="p">,</span> <span class="n">min_length</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Print ngrams with at least `min_count` counts and each component</span>
<span class="sd">    exceeds `min_length` in characters.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ngram</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">ngram_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">each_elem_is_long_enough</span><span class="p">(</span><span class="n">ngram</span><span class="p">,</span> <span class="n">min_length</span><span class="p">)</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="n">min_count</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ngram</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">each_elem_is_long_enough</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">min_length</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_length</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>


<span class="n">word_counts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ngrams</span><span class="p">(</span><span class="n">filtered_lowercase_words</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">word_counts</span> <span class="o">=</span> <span class="n">sort_dict_by_vals</span><span class="p">(</span><span class="n">count_ngrams</span><span class="p">(</span><span class="n">word_counts</span><span class="p">))</span>
<span class="n">print_top_vals</span><span class="p">(</span><span class="n">word_counts</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;great&#39;,) 50
(&#39;one&#39;,) 51
(&#39;like&#39;,) 53
(&#39;delicious&#39;,) 57
(&#39;farmer&#39;,) 60
(&#39;healthy&#39;,) 65
(&#39;good&#39;,) 66
(&#39;vending&#39;,) 77
(&#39;fridge&#39;,) 85
(&#39;salads&#39;,) 87
(&#39;machine&#39;,) 92
(&#39;fresh&#39;,) 97
(&quot;n&#39;t&quot;,) 100
(&#39;food&#39;,) 111
(&#39;salad&#39;,) 220
</pre></div>
</div>
</div>
</div>
<p>Unsurprisingly, salad is the most common word.
Positive words include “great”, “like”, “delicious”, “healthy”, “good”, and “fresh”.
Because the overall rating across all reviews is high, around 4.3, it’s also unsurprising there are no negative words in the most frequent list.
We can repeat the above for bigrams and trigrams, which are strings of two and three words, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bigrams</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ngrams</span><span class="p">(</span><span class="n">filtered_lowercase_words</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">bigram_counts</span> <span class="o">=</span> <span class="n">sort_dict_by_vals</span><span class="p">(</span><span class="n">count_ngrams</span><span class="p">(</span><span class="n">bigrams</span><span class="p">))</span>
<span class="n">print_top_vals</span><span class="p">(</span><span class="n">bigram_counts</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&quot;n&#39;t&quot;, &#39;wait&#39;) 10
(&#39;could&#39;, &quot;n&#39;t&quot;) 10
(&#39;southwest&#39;, &#39;salad&#39;) 10
(&#39;napa&#39;, &#39;salad&#39;) 12
(&#39;revival&#39;, &#39;food&#39;) 13
(&#39;food&#39;, &#39;hall&#39;) 13
(&#39;salad&#39;, &#39;vending&#39;) 15
(&#39;vending&#39;, &#39;machines&#39;) 16
(&#39;farmers&#39;, &#39;fridge&#39;) 19
(&#39;vending&#39;, &#39;machine&#39;) 60
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trigrams</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ngrams</span><span class="p">(</span><span class="n">filtered_lowercase_words</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">trigram_counts</span> <span class="o">=</span> <span class="n">sort_dict_by_vals</span><span class="p">(</span><span class="n">count_ngrams</span><span class="p">(</span><span class="n">trigrams</span><span class="p">))</span>
<span class="n">print_top_vals</span><span class="p">(</span><span class="n">trigram_counts</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;north&#39;, &#39;napa&#39;, &#39;salad&#39;) 5
(&#39;high&#39;, &#39;protein&#39;, &#39;salad&#39;) 5
(&#39;honey&#39;, &#39;mustard&#39;, &#39;dressing&#39;) 6
(&#39;salad&#39;, &#39;vending&#39;, &#39;machine&#39;) 13
(&#39;revival&#39;, &#39;food&#39;, &#39;hall&#39;) 13
</pre></div>
</div>
</div>
</div>
<p>These are less informative as they are not positive word plus noun.
Instead, they seem to be names of menu items or expected phrases, like “Farmer’s Fridge” and “vending machine”.</p>
<p>Since most of the reviews are positive, it’s interesting to repeat the ngram analysis for negative reviews only.
Only about 10% of reviews have a rating of 2 or lower.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">negative_text</span> <span class="o">=</span> <span class="n">combine_review_text</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">rating</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">words</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">negative_text</span><span class="p">)</span>
<span class="n">filtered_lowercase_words</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop_words</span><span class="p">:</span>
        <span class="n">filtered_lowercase_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<span class="n">filtered_lowercase_words</span><span class="p">[:</span><span class="mi">12</span><span class="p">]</span>

<span class="n">word_counts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ngrams</span><span class="p">(</span><span class="n">filtered_lowercase_words</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">word_counts</span> <span class="o">=</span> <span class="n">sort_dict_by_vals</span><span class="p">(</span><span class="n">count_ngrams</span><span class="p">(</span><span class="n">word_counts</span><span class="p">))</span>
<span class="n">print_top_vals</span><span class="p">(</span><span class="n">word_counts</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;prices&#39;,) 5
(&#39;like&#39;,) 5
(&#39;revival&#39;,) 5
(&#39;hall&#39;,) 5
(&#39;back&#39;,) 5
(&#39;little&#39;,) 5
(&#39;open&#39;,) 5
(&#39;times&#39;,) 5
(&#39;lettuce&#39;,) 5
(&#39;got&#39;,) 6
(&#39;would&#39;,) 7
(&#39;vending&#39;,) 8
(&#39;lunch&#39;,) 8
(&#39;machine&#39;,) 13
(&quot;n&#39;t&quot;,) 13
(&#39;food&#39;,) 14
(&#39;salad&#39;,) 20
</pre></div>
</div>
</div>
</div>
<p>While we don’t see obvious negative terms like “bad”, we can infer from the given words that these reviewers didn’t like the “prices”, “little” [portions?], [available?] “times”, etc.
Similarly from the bigrams and trigrams,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bigrams</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ngrams</span><span class="p">(</span><span class="n">filtered_lowercase_words</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">bigram_counts</span> <span class="o">=</span> <span class="n">sort_dict_by_vals</span><span class="p">(</span><span class="n">count_ngrams</span><span class="p">(</span><span class="n">bigrams</span><span class="p">))</span>
<span class="n">print_top_vals</span><span class="p">(</span><span class="n">bigram_counts</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;salad&#39;, &#39;vending&#39;) 2
(&#39;every&#39;, &#39;day&#39;) 2
(&#39;open&#39;, &#39;9am&#39;) 2
(&#39;used&#39;, &#39;get&#39;) 2
(&#39;salad&#39;, &#39;portions&#39;) 2
(&#39;brown&#39;, &#39;lettuce&#39;) 2
(&#39;come&#39;, &#39;back&#39;) 3
(&#39;could&#39;, &quot;n&#39;t&quot;) 3
(&#39;revival&#39;, &#39;food&#39;) 5
(&#39;food&#39;, &#39;hall&#39;) 5
(&#39;vending&#39;, &#39;machine&#39;) 7
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trigrams</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ngrams</span><span class="p">(</span><span class="n">filtered_lowercase_words</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">trigram_counts</span> <span class="o">=</span> <span class="n">sort_dict_by_vals</span><span class="p">(</span><span class="n">count_ngrams</span><span class="p">(</span><span class="n">trigrams</span><span class="p">))</span>
<span class="n">print_top_vals</span><span class="p">(</span><span class="n">trigram_counts</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;salad&#39;, &#39;vending&#39;, &#39;machine&#39;) 2
(&#39;revival&#39;, &#39;food&#39;, &#39;hall&#39;) 5
</pre></div>
</div>
</div>
</div>
<p>we can infer things like these reviewers were not impressed by the salad portions or the vending machine (perhaps they were just not expecting one?).</p>
</section>
</section>
<section id="future-work">
<span id="yelp-future"></span><h2>Future Work<a class="headerlink" href="#future-work" title="Permalink to this headline">#</a></h2>
<p>These analyses would benefit from more review data and more use of data already collected in reviews.
The Selenium web-scraping approach is very flexible and generalizable.
Future work can automate it to search for all fridge locations in Chicago and scrape all locations with 1 or more reviews.
It is also easy to extend this approach to other cities, like New York City.
I collected lots of metadata, like how many other reviews a given reviewer has posted or whether they’ve obtained the “Elite” Yelp user status.
In addition, it may be useful to take a more detailed look at reviews that have lots of engagement, measured by how many other Yelpers found the review useful, funny, and/or cool.</p>
<p>Additional data could be estimated from the variables collected, for example reviewer sex from an analysis of their names.
This could be useful information if Farmer’s Fridge wanted to better target a particular demographic.
More in depth natural language processing could also be useful to improve the accuracy of the popularity metrics, e.g. salad popularity.
Rather than just looking at if “salad” was mentioned, analyzing the sentiment around that mention would give better information.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "adamwangdata/adamwangdata.github.io",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./stat-ml"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../deploy/churn.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Predicting Churn with Amazon SageMaker</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="forecast.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Time Series Forecasting</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Adam Wang<br/>
  
      &copy; Copyright 2021.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>